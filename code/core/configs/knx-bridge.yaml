# KNX Bridge Configuration
# ========================
#
# This file configures the KNX protocol bridge, mapping Gray Logic devices
# to KNX group addresses. The bridge translates MQTT commands to KNX telegrams
# and publishes KNX state changes back to MQTT.
#
# Configuration can also be set via environment variables:
#   KNX_BRIDGE_ID=knx-bridge-01
#   KNX_BRIDGE_KNXD_CONNECTION=tcp://localhost:6720
#   KNX_BRIDGE_MQTT_BROKER=tcp://localhost:1883
#   KNX_BRIDGE_MQTT_USERNAME=user
#   KNX_BRIDGE_MQTT_PASSWORD=secret

# ============================================================================
# BRIDGE IDENTITY
# ============================================================================

bridge:
  # Unique identifier for this bridge instance.
  # Used in MQTT client ID and health reporting topics.
  id: "knx-bridge-01"

  # How often to publish health status (seconds).
  # Health is published to: graylogic/health/knx
  health_interval: 30

# ============================================================================
# KNXD CONNECTION
# ============================================================================
#
# The bridge connects to knxd (KNX daemon) to communicate with the KNX bus.
# Install knxd: https://github.com/knxd/knxd
#
# Common connection formats:
#   - Unix socket: unix:///run/knxd
#   - TCP: tcp://localhost:6720

knxd:
  # Connection URL for knxd daemon
  connection: "tcp://localhost:6720"

  # Maximum time to wait for connection (seconds)
  connect_timeout: 10

  # Timeout for read operations (seconds)
  read_timeout: 30

  # Delay between reconnection attempts (seconds)
  reconnect_interval: 5

# ============================================================================
# MQTT SETTINGS
# ============================================================================
#
# NOTE: When the KNX bridge is wired into main.go, these settings are
# typically ignored since the bridge uses the shared MQTT client from
# Gray Logic Core. They are here for standalone bridge operation.

mqtt:
  # MQTT broker URL
  broker: "tcp://localhost:1883"

  # MQTT client ID (defaults to bridge.id + "-mqtt" if not set)
  client_id: ""

  # Authentication (optional)
  username: ""
  password: ""

  # Quality of Service level (0, 1, or 2)
  # QoS 1 = At least once delivery (recommended)
  qos: 1

  # Keep-alive interval (seconds)
  keep_alive: 60

# ============================================================================
# LOGGING
# ============================================================================

logging:
  # Log level: debug, info, warn, error
  level: "info"

  # Log format: json, text
  format: "json"

# ============================================================================
# DEVICE MAPPINGS
# ============================================================================
#
# Devices are NOT configured in this file. They are managed through:
#   1. ETS import: POST /commissioning/ets/import (bulk provisioning from .knxproj)
#   2. Manual entry: POST /devices via the Flutter admin panel
#
# The bridge loads deviceâ†’GA mappings from the device registry at startup
# and via hot-reload after ETS import (ReloadDevices).
# It starts with zero devices and picks them up from the registry.
