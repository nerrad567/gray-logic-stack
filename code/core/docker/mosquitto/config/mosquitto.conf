# Mosquitto Configuration for Gray Logic Development
#
# This configuration is for LOCAL DEVELOPMENT ONLY.
# Production deployments should use TLS and authentication.

# ==========================================================================
# LISTENERS
# ==========================================================================

# MQTT listener (standard protocol)
listener 1883
protocol mqtt

# WebSocket listener (for browser-based tools like MQTT Explorer)
listener 9001
protocol websockets

# ==========================================================================
# SECURITY
# ==========================================================================

# Allow anonymous connections (dev only - localhost is trusted)
# Production: set to false and configure password_file or auth plugin
allow_anonymous true

# ==========================================================================
# PERSISTENCE
# ==========================================================================

# Enable persistence for retained messages and subscriptions
persistence true
persistence_location /mosquitto/data/

# ==========================================================================
# LOGGING
# ==========================================================================

# Log to file and stdout
log_dest file /mosquitto/log/mosquitto.log
log_dest stdout

# Log types (connection, subscribe, notice for dev visibility)
log_type error
log_type warning
log_type notice
log_type information
log_type subscribe
log_type unsubscribe

# Include client IDs in logs (helpful for debugging)
connection_messages true

# ==========================================================================
# MESSAGE SETTINGS
# ==========================================================================

# Maximum packet size (256KB - sufficient for device state payloads)
max_packet_size 262144

# Maximum inflight messages (QoS 1 and 2)
max_inflight_messages 20

# Maximum queued messages per client
max_queued_messages 1000

# Message expiry (5 minutes - prevents stale retained messages)
# Note: Only applies to messages without explicit expiry
message_size_limit 262144

# ==========================================================================
# CLIENT SETTINGS
# ==========================================================================

# Maximum number of client connections
max_connections -1

# Keepalive interval (if client doesn't specify)
max_keepalive 300
