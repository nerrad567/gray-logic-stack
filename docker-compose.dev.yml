version: '3.8'

services:
  # MQTT Broker
  mosquitto:
    image: eclipse-mosquitto:2.0.18
    ports:
      - "1883:1883"
      - "9001:9001"
    volumes:
      - ./code/core/docker/mosquitto/config:/mosquitto/config
      - mosquitto_data:/mosquitto/data
      - mosquitto_log:/mosquitto/log

  # Time Series Database
  influxdb:
    image: influxdb:2.7-alpine
    ports:
      - "8086:8086"
    environment:
      - DOCKER_INFLUXDB_INIT_MODE=setup
      - DOCKER_INFLUXDB_INIT_USERNAME=graylogic
      - DOCKER_INFLUXDB_INIT_PASSWORD=dev-password-only
      - DOCKER_INFLUXDB_INIT_ORG=graylogic
      - DOCKER_INFLUXDB_INIT_BUCKET=graylogic
    volumes:
      - influxdb_data:/var/lib/influxdb2

volumes:
  mosquitto_data:
  mosquitto_log:
  influxdb_data:
