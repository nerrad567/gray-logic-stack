# KNXSim Default Configuration
# =============================
# Realistic sample home demonstrating KNX installation patterns.
# Each room has: light, wall switch, room thermostat, presence detector.
# Actuators are centralized in Distribution Board (as in real installations).
#
# KEY CONCEPT: Devices vs Loads
# - DEVICES are KNX bus participants (actuators, sensors, buttons) with individual addresses
# - LOADS are dumb equipment (lights, motors, valves) controlled BY actuator channels
# Loads have NO individual address - they're just 230V equipment wired to relay outputs.
#
# GA Structure: Standard 3-level (Main=Function, Middle=Floor, Sub=Object)
#   1/x/x = Lighting
#   3/x/x = HVAC / Heating
#   4/x/x = Sensors (presence, brightness)
#
# Topology: Area 1, Line 1 (single TP line)
#   Each premise in KNXSim = one physical TP line with its own KNXnet/IP interface.
#   All devices share one line. In larger buildings, you'd create multiple premises
#   (one per TP line), each with its own KNXnet/IP port.
#   1.1.1-2  = Actuators (switch, heating) - Distribution Board
#   1.1.3-7  = Wall controls (push buttons)
#   1.1.8-17 = Room controllers (thermostats, presence)
#
# ROOM THERMOSTAT PATTERN:
# Each room thermostat has a built-in temp sensor, setpoint, and heating output.
# The heating_output GA matches the heating actuator valve channel GA.
# When thermostat calculates demand (0-100%), it sends to that GA,
# and the heating actuator opens the valve proportionally.

topology:
  area_number: 1
  line_number: 1

devices:
  # ============================================
  # DISTRIBUTION BOARD - ACTUATORS
  # ============================================

  # 6-fold Switch Actuator for Lighting
  # Controls all room lights from the distribution board
  # Real device: MDT AKS-0616.03 / ABB SA/S 6.16.1
  - id: "light-actuator-6ch"
    type: "switch_actuator_6fold"
    individual_address: "1.1.1"
    room_id: "distribution-board"
    group_addresses:
      # Channel A - Living Room Light
      channel_a_switch: "1/0/1"
      channel_a_switch_status: "1/0/2"
      # Channel B - Kitchen Light
      channel_b_switch: "1/0/10"
      channel_b_switch_status: "1/0/11"
      # Channel C - Hallway Light
      channel_c_switch: "1/0/20"
      channel_c_switch_status: "1/0/21"
      # Channel D - Bedroom Light (First Floor ‚Üí middle group 1)
      channel_d_switch: "1/1/1"
      channel_d_switch_status: "1/1/2"
      # Channel E - Bathroom Light (First Floor ‚Üí middle group 1)
      channel_e_switch: "1/1/10"
      channel_e_switch_status: "1/1/11"
      # Channel F - Spare
      channel_f_switch: "1/0/50"
      channel_f_switch_status: "1/0/51"

  # 6-fold Heating Actuator for Underfloor Heating Manifold
  # Controls zone valves for each room - PROPORTIONAL (0-100%)
  # Real device: MDT AKH-0600.02 / ABB VAA/S 6.230.2.1
  # DPT 5.001 = percentage for proportional valve control
  - id: "heating-actuator-6ch"
    type: "heating_actuator_6fold"
    individual_address: "1.1.2"
    room_id: "distribution-board"
    group_addresses:
      # Channel A - Living Room UFH Valve (receives from thermostat)
      channel_a_valve:
        ga: "3/0/1"
        dpt: "5.001"
      channel_a_valve_status:
        ga: "3/0/2"
        dpt: "5.001"
      # Channel B - Kitchen UFH Valve
      channel_b_valve:
        ga: "3/0/10"
        dpt: "5.001"
      channel_b_valve_status:
        ga: "3/0/11"
        dpt: "5.001"
      # Channel C - Hallway UFH Valve
      channel_c_valve:
        ga: "3/0/20"
        dpt: "5.001"
      channel_c_valve_status:
        ga: "3/0/21"
        dpt: "5.001"
      # Channel D - Bedroom UFH Valve (First Floor ‚Üí middle group 1)
      channel_d_valve:
        ga: "3/1/1"
        dpt: "5.001"
      channel_d_valve_status:
        ga: "3/1/2"
        dpt: "5.001"
      # Channel E - Bathroom UFH Valve (First Floor ‚Üí middle group 1)
      channel_e_valve:
        ga: "3/1/10"
        dpt: "5.001"
      channel_e_valve_status:
        ga: "3/1/11"
        dpt: "5.001"
      # Channel F - Spare
      channel_f_valve:
        ga: "3/0/50"
        dpt: "5.001"
      channel_f_valve_status:
        ga: "3/0/51"
        dpt: "5.001"

  # ============================================
  # LIVING ROOM DEVICES
  # ============================================

  # Wall Switch - Living Room
  - id: "switch-living"
    type: "push_button_2fold"
    individual_address: "1.1.3"
    room_id: "living-room"
    group_addresses:
      button_1: "1/0/1" # ‚Üí Light actuator Ch A
      button_1_led: "1/0/2" # ‚Üê Status feedback

  # Room Thermostat - Living Room
  # Built-in temp sensor + PI controller + heating output
  # heating_output sends demand (0-100%) to heating actuator channel A
  - id: "thermostat-living"
    type: "thermostat"
    individual_address: "1.1.8"
    room_id: "living-room"
    group_addresses:
      actual_temperature:
        ga: "3/0/3"
        dpt: "9.001"
      setpoint:
        ga: "3/0/4"
        dpt: "9.001"
      heating_output:
        ga: "3/0/1" # ‚Üí Heating actuator Ch A valve
        dpt: "5.001"
    initial:
      current_temperature: 21.5
      setpoint: 21.0

  # Presence Detector - Living Room
  - id: "presence-living"
    type: "presence"
    individual_address: "1.1.9"
    room_id: "living-room"
    group_addresses:
      presence: "4/0/1"
      lux: "4/0/2"
    initial:
      presence: false
      lux: 300

  # ============================================
  # KITCHEN DEVICES
  # ============================================

  - id: "switch-kitchen"
    type: "push_button_2fold"
    individual_address: "1.1.4"
    room_id: "kitchen"
    group_addresses:
      button_1: "1/0/10"
      button_1_led: "1/0/11"

  - id: "thermostat-kitchen"
    type: "thermostat"
    individual_address: "1.1.10"
    room_id: "kitchen"
    group_addresses:
      actual_temperature:
        ga: "3/0/13"
        dpt: "9.001"
      setpoint:
        ga: "3/0/14"
        dpt: "9.001"
      heating_output:
        ga: "3/0/10" # ‚Üí Heating actuator Ch B valve
        dpt: "5.001"
    initial:
      current_temperature: 22.0
      setpoint: 20.0

  - id: "presence-kitchen"
    type: "presence"
    individual_address: "1.1.11"
    room_id: "kitchen"
    group_addresses:
      presence: "4/0/10"
      lux: "4/0/11"
    initial:
      presence: false
      lux: 400

  # ============================================
  # HALLWAY DEVICES
  # ============================================

  - id: "switch-hallway"
    type: "push_button_2fold"
    individual_address: "1.1.5"
    room_id: "hallway"
    group_addresses:
      button_1: "1/0/20"
      button_1_led: "1/0/21"

  - id: "thermostat-hallway"
    type: "thermostat"
    individual_address: "1.1.12"
    room_id: "hallway"
    group_addresses:
      actual_temperature:
        ga: "3/0/23"
        dpt: "9.001"
      setpoint:
        ga: "3/0/24"
        dpt: "9.001"
      heating_output:
        ga: "3/0/20" # ‚Üí Heating actuator Ch C valve
        dpt: "5.001"
    initial:
      current_temperature: 19.5
      setpoint: 18.0

  - id: "presence-hallway"
    type: "presence"
    individual_address: "1.1.13"
    room_id: "hallway"
    group_addresses:
      presence: "4/0/20"
      lux: "4/0/21"
    initial:
      presence: false
      lux: 100

  # ============================================
  # BEDROOM DEVICES
  # ============================================

  - id: "switch-bedroom"
    type: "push_button_2fold"
    individual_address: "1.1.6"
    room_id: "bedroom"
    group_addresses:
      button_1: "1/1/1"
      button_1_led: "1/1/2"

  - id: "thermostat-bedroom"
    type: "thermostat"
    individual_address: "1.1.14"
    room_id: "bedroom"
    group_addresses:
      actual_temperature:
        ga: "3/1/3"
        dpt: "9.001"
      setpoint:
        ga: "3/1/4"
        dpt: "9.001"
      heating_output:
        ga: "3/1/1" # ‚Üí Heating actuator Ch D valve
        dpt: "5.001"
    initial:
      current_temperature: 20.0
      setpoint: 19.0

  - id: "presence-bedroom"
    type: "presence"
    individual_address: "1.1.15"
    room_id: "bedroom"
    group_addresses:
      presence: "4/1/1"
      lux: "4/1/2"
    initial:
      presence: false
      lux: 50

  # ============================================
  # BATHROOM DEVICES
  # ============================================

  - id: "switch-bathroom"
    type: "push_button_2fold"
    individual_address: "1.1.7"
    room_id: "bathroom"
    group_addresses:
      button_1: "1/1/10"
      button_1_led: "1/1/11"

  - id: "thermostat-bathroom"
    type: "thermostat"
    individual_address: "1.1.16"
    room_id: "bathroom"
    group_addresses:
      actual_temperature:
        ga: "3/1/13"
        dpt: "9.001"
      setpoint:
        ga: "3/1/14"
        dpt: "9.001"
      heating_output:
        ga: "3/1/10" # ‚Üí Heating actuator Ch E valve
        dpt: "5.001"
    initial:
      current_temperature: 23.0
      setpoint: 22.0

  - id: "presence-bathroom"
    type: "presence"
    individual_address: "1.1.17"
    room_id: "bathroom"
    group_addresses:
      presence: "4/1/10"
      lux: "4/1/11"
    initial:
      presence: false
      lux: 200

# ============================================
# SCENARIOS (Simulated sensor behavior)
# ============================================
scenarios:
  # Thermal simulation - realistic temperature based on heating state
  # When valve is open, temp rises; when closed, temp falls toward ambient
  # Parameters tuned so heating at ~50% maintains ~20¬∞C with 10¬∞C ambient
  - device_id: "thermostat-living"
    field: "current_temperature"
    type: "thermal_simulation"
    params:
      ambient_temp: 10.0 # Outside temperature
      heating_power: 0.5 # ¬∞C/min at 100% valve
      heat_loss_rate: 0.02 # Heat loss rate per ¬∞C difference
      interval_seconds: 10

  - device_id: "thermostat-kitchen"
    field: "current_temperature"
    type: "thermal_simulation"
    params:
      ambient_temp: 10.0
      heating_power: 0.6 # Smaller room, heats faster
      heat_loss_rate: 0.025
      interval_seconds: 10

  - device_id: "thermostat-hallway"
    field: "current_temperature"
    type: "thermal_simulation"
    params:
      ambient_temp: 10.0
      heating_power: 0.4 # Hallway - draft, less efficient
      heat_loss_rate: 0.03 # More heat loss (doors opening)
      interval_seconds: 10

  - device_id: "thermostat-bedroom"
    field: "current_temperature"
    type: "thermal_simulation"
    params:
      ambient_temp: 10.0
      heating_power: 0.55
      heat_loss_rate: 0.018 # Well insulated, less loss
      interval_seconds: 10

  - device_id: "thermostat-bathroom"
    field: "current_temperature"
    type: "thermal_simulation"
    params:
      ambient_temp: 10.0
      heating_power: 0.7 # Small room, heats quickly
      heat_loss_rate: 0.03 # Ventilation = more loss
      interval_seconds: 10

  # Presence patterns
  - device_id: "presence-living"
    field: "presence"
    type: "presence_pattern"
    params:
      occupied_min_seconds: 60
      occupied_max_seconds: 300
      empty_min_seconds: 30
      empty_max_seconds: 120

  - device_id: "presence-hallway"
    field: "presence"
    type: "presence_pattern"
    params:
      occupied_min_seconds: 5
      occupied_max_seconds: 30
      empty_min_seconds: 60
      empty_max_seconds: 300

# ============================================
# LOADS (Physical equipment - NOT KNX devices)
# ============================================
loads:
  # Lights controlled by the 6-fold switch actuator
  - id: "load-light-living"
    name: "Living Room Light"
    type: "light"
    icon: "üí°"
    actuator_device_id: "light-actuator-6ch"
    actuator_channel_id: "A"
    room_id: "living-room"

  - id: "load-light-kitchen"
    name: "Kitchen Light"
    type: "light"
    icon: "üí°"
    actuator_device_id: "light-actuator-6ch"
    actuator_channel_id: "B"
    room_id: "kitchen"

  - id: "load-light-hallway"
    name: "Hallway Light"
    type: "light"
    icon: "üí°"
    actuator_device_id: "light-actuator-6ch"
    actuator_channel_id: "C"
    room_id: "hallway"

  - id: "load-light-bedroom"
    name: "Bedroom Light"
    type: "light"
    icon: "üí°"
    actuator_device_id: "light-actuator-6ch"
    actuator_channel_id: "D"
    room_id: "bedroom"

  - id: "load-light-bathroom"
    name: "Bathroom Light"
    type: "light"
    icon: "üí°"
    actuator_device_id: "light-actuator-6ch"
    actuator_channel_id: "E"
    room_id: "bathroom"

  # UFH zone valves controlled by the 6-fold heating actuator
  - id: "load-ufh-living"
    name: "UFH Valve"
    type: "valve"
    icon: "üî•"
    actuator_device_id: "heating-actuator-6ch"
    actuator_channel_id: "A"
    room_id: "living-room"

  - id: "load-ufh-kitchen"
    name: "UFH Valve"
    type: "valve"
    icon: "üî•"
    actuator_device_id: "heating-actuator-6ch"
    actuator_channel_id: "B"
    room_id: "kitchen"

  - id: "load-ufh-hallway"
    name: "UFH Valve"
    type: "valve"
    icon: "üî•"
    actuator_device_id: "heating-actuator-6ch"
    actuator_channel_id: "C"
    room_id: "hallway"

  - id: "load-ufh-bedroom"
    name: "UFH Valve"
    type: "valve"
    icon: "üî•"
    actuator_device_id: "heating-actuator-6ch"
    actuator_channel_id: "D"
    room_id: "bedroom"

  - id: "load-ufh-bathroom"
    name: "UFH Valve"
    type: "valve"
    icon: "üî•"
    actuator_device_id: "heating-actuator-6ch"
    actuator_channel_id: "E"
    room_id: "bathroom"
